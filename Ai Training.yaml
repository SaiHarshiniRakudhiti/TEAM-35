---
name: AI Training
nodes:
- parameters:
    httpMethod: POST
    path: mental-wellness-chat
    responseMode: responseNode
    options: {}
  id: 8df6de95-26fd-4a1d-a55c-76f898cecdec
  name: Webhook
  type: n8n-nodes-base.webhook
  typeVersion: 1.1
  position:
  - -1632
  - 2384
  webhookId: mental-wellness-chat
- parameters:
    respondWith: json
    responseBody: '={{ { "reply": $json.output } }}'
    options: {}
  id: fffaf40b-e31a-4ea8-ad94-8880669bdeeb
  name: Respond to Webhook
  type: n8n-nodes-base.respondToWebhook
  typeVersion: 1.1
  position:
  - -384
  - 2480
- parameters:
    jsCode: |
      // Get message safely from chat or webhook
      const text =
        $json.message ||
        $json.body?.message ||
        $json.chatInput ||
        "";

      // Default values
      let emotion = "neutral";
      let intensity = 0.2;

      // Simple keyword-based emotion detection
      if (text.toLowerCase().includes("stress")) {
        emotion = "stress";
        intensity = 0.8;
      } else if (text.toLowerCase().includes("sad")) {
        emotion = "sad";
        intensity = 0.7;
      } else if (text.toLowerCase().includes("angry")) {
        emotion = "anger";
        intensity = 0.75;
      }

      return {
        user_message: text,
        emotion_state: {
          emotion,
          intensity,
          confidence: 0.6
        }
      };
  type: n8n-nodes-base.code
  typeVersion: 2
  position:
  - -1408
  - 2480
  id: babee154-7a15-4ad7-b39b-cff20f5ca740
  name: Emotion Analyzer
- parameters:
    options: {}
  type: "@n8n/n8n-nodes-langchain.chatTrigger"
  typeVersion: 1.4
  position:
  - -1632
  - 2576
  id: 5e42ce38-a2a3-40d6-8a5a-b17740d292ef
  name: When chat message received
  webhookId: 9f5610ef-732d-4e1b-8163-76bfb5126474
- parameters:
    conditions:
      options:
        caseSensitive: true
        leftValue: ''
        typeValidation: strict
        version: 3
      conditions:
      - id: 66ec221a-b264-4f53-8204-26868d16c528
        leftValue: "={{ $json.user_stage }}\n"
        rightValue: beginner
        operator:
          type: string
          operation: equals
      - id: e53d8f07-c054-4d2d-a460-177d0d739e14
        leftValue: "={{ $json.user_stage }}"
        rightValue: focus_mode
        operator:
          type: string
          operation: equals
      - id: e4ad9ec4-1209-4e82-8b46-6d2313062e00
        leftValue: "={{ $json.user_stage }}  "
        rightValue: training
        operator:
          type: string
          operation: equals
      - id: 7fe592be-e5ce-48f7-9059-d5986b97994a
        leftValue: "={{ $json.user_stage }}"
        rightValue: advanced
        operator:
          type: string
          operation: equals
      combinator: and
    options: {}
  type: n8n-nodes-base.if
  typeVersion: 2.3
  position:
  - -960
  - 2480
  id: 177dc1f6-5721-468d-98cd-a408b6b7ec8e
  name: user stage router
- parameters:
    promptType: define
    text: "={{ $json.user_message }}"
    options:
      systemMessage: |-
        You are a calm and friendly mental wellness AI.

        The user is in BEGINNER stage.
        Your task is ONLY to understand the user better.

        Ask 3â€“5 simple, non-overwhelming questions.
        Ask ONE question at a time.

        Topics you can ask about:
        - stress level
        - daily routine
        - sleep quality
        - focus problems
        - what they want help with

        Do NOT give advice.
        Do NOT suggest solutions.
        Do NOT motivate yet.

        Just ask the first question politely.
  type: "@n8n/n8n-nodes-langchain.agent"
  typeVersion: 3
  position:
  - -736
  - 2480
  id: e21ed63d-691f-49a1-a48e-00f6b87b5eaf
  name: Beginner Training Questions
- parameters: {}
  type: "@n8n/n8n-nodes-langchain.memoryBufferWindow"
  typeVersion: 1.3
  position:
  - -608
  - 2704
  id: 59049bd3-9048-43c8-a4db-1f2031e35fe9
  name: Simple Memory1
- parameters:
    assignments:
      assignments:
      - id: id-1
        name: user_stage
        value: beginner
        type: string
    includeOtherFields: true
    options: {}
  id: 16b695f2-071e-4103-913e-a0ab0f856087
  name: Set Default User Stage
  type: n8n-nodes-base.set
  typeVersion: 3.4
  position:
  - -1184
  - 2480
- parameters:
    model:
      __rl: true
      mode: list
      value: gpt-4.1-mini
    builtInTools: {}
    options: {}
  type: "@n8n/n8n-nodes-langchain.lmChatOpenAi"
  typeVersion: 1.3
  position:
  - -880
  - 2688
  id: d47a318a-64e3-47b1-9607-c90b32faedcb
  name: OpenAI Chat Model
  credentials:
    openAiApi:
      id: J6g4PsIMFl1Q3TY5
      name: n8n free OpenAI API credits
pinData: {}
connections:
  Webhook:
    main:
    - - node: Emotion Analyzer
        type: main
        index: 0
  When chat message received:
    main:
    - - node: Emotion Analyzer
        type: main
        index: 0
  user stage router:
    main:
    - - node: Beginner Training Questions
        type: main
        index: 0
  Beginner Training Questions:
    main:
    - - node: Respond to Webhook
        type: main
        index: 0
  Simple Memory1:
    ai_memory:
    - - node: Beginner Training Questions
        type: ai_memory
        index: 0
  Emotion Analyzer:
    main:
    - - node: Set Default User Stage
        type: main
        index: 0
  Set Default User Stage:
    main:
    - - node: user stage router
        type: main
        index: 0
  OpenAI Chat Model:
    ai_languageModel:
    - - node: Beginner Training Questions
        type: ai_languageModel
        index: 0
active: true
settings:
  executionOrder: v1
versionId: b3ef078b-17cc-4ce6-8c50-06f8e674e852
meta:
  templateCredsSetupCompleted: true
  instanceId: f8d34184d562231152a062016d5e99ebe39b5ba2eb766ec6df8f6a85525d44c8
id: ibE1WCaYoJwo8Zyc
tags: []
